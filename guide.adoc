# How to integrate BluePrism Digital Workers and use them inside your processes and cases within Red Hat Process Automation Manager.

## Introduction

Business automation platforms can work together with Robotic Process Automation platforms in order to boost performance and reduce organization costs. In the automation journey, a business automation platform provides all the necessary tooling to allow the teams to author processes and cases based on mature specifications like BPMN2 and CMMN along with many business-friendly ways to automate decisions. Not only this, but these platforms also provides the management and an execution environment for these projects that when in-use will produce valuable data used by the C-level for decision making.

One of the main goals is to support the implementation of the whole business process and decisioning lifecycle, delivering process-driven applications which spawns horizontally across the organization.

On the automation scope there are also RPA softwares which brings the possibility to create robots that can automate manual tasks. These robots are can interact with desktop applications, web applications, spreadsheets, e-mail inboxes and many other different tools. This means that any repeatable work mainly executed by a human can be automated and the execution can be replaced by the required number of robots. These work automation improves the efficiency of people work and allocation.

When aligning the usage of an RPA tool with a business automation platform, we expand our digital automation to a scenario where the corporation process management practice is properly addressed and the human work is made more efficient.

There are several advantages on this approach:
- Being able to track the organization functioning across process monitoring that includes robots tasks;
- Being able to identify bottlenecks on the organization functioning through a business automation platform and taking the action of improving it by using robot automation;
- Using digital workers to make your process function whenever: including weekends.
- Be able to easily scale the number of digital workers for seasional process needs;

Knowing this, Red Hat and BluePrism aligned forces and got together to provide even more ways for users to be successful. RHPAM - Red Hat Process Automation Manager (a.k.a. RHPAM) is an open-source platform for intelligent process and decisioning. BluePrism is an RPA tool that provides tool for creating, executing and monitooring robots, Digital Workers, supporting the automation of repeatable tasks.

With this in mind, this document has technical details on how it is possible to use BluePrism digital workers within business processes or cases created in RHPAM to efficiently accomplish business goals.

## Pre-requisites

1. Have an environment with BluePrism #TODO [include version here];
2. Have an environment with RHPAM 7.5.x or higher;
3. Download BluePrism Task. It can be downloaded at #TODO[ Link here]

## Configuring BluePrism

BluePrism is currently targeted for a windows environment. You can install it on premise or spawn machines in Azure cloud to model and execute your robots. More details can be found at [Insert links here].

Once you have the platform up and running, these are basically the points you should work on:

- Model objects and processes that knows how to execute the specific tasks;
- Expose your processes via Web Services API.
- Configure the firewall to allow access to the port where BluePrism is running;
- If running on Azure, configure the inbound and outbound configuration to redirect the access to BluePrism;

## Configuring RHPAM

RHPAM is Java based therefore it can run in all operation systems that currently supports Java. It can either be provisioned on premise or within an OpenShift platform.

The integration from RHPAM to BluePrism is made via SOAP communication [1]. So, in order to invoke a BluePrism WebService we should either use the default Web Service Task which comes out-of-the-box within RHPAM, or create a custom task to represent this invocation. In this guide, we will show how to use a BluePrism task, a custom task to accomplish this goal [2].

### Business Central

#### Installing BluePrism Task

In order to use custom tasks, you should first make them available in the environment both for authoring and execution purposes. Here's how you can install the BluePrism task:

1. Login to Business Central, and go to the general settings. You can access it by selecting the gear on the top-right corner.
2. Within the configuration page, select the `Service Tasks Administration` option.

image::images/1-service-tasks.png[]

[start=3]
3. Let's upload the jar package that contains the BluePrism Task. Click on the `Add Service Task` button, and provide the jar that contains the custom task, in this case, `blueprism-wih-7.23.0.Final-redhat-00003.jar`.
[#TODO check the errorr that is ocurring on pam 750 18:50:28,212 ERROR [io.undertow.request] (default task-9) UT005023: Exception handling request to /business-central/maven2: java.lang.RuntimeException: org.eclipse.aether.deployment.DeploymentException: Failed to deploy artifacts: Could not transfer artifact org.jbpm.contrib:blueprism-wih:jar:7.23.0.Final-redhat-00003 from/to jboss-releases-repository (https://repository.jboss.org/nexus/service/local/staging/deploy/maven2/): repository.jboss.org]

You have now made available this BluePrism Service Task within the authoring environment. Now we need to configure it in the project where we want to use it.

#### Adding BluePrism task to a Business Project

In RHPAM, it is necessary to configure service tasks on the projects where it is going to be used. Follow this steps to allow using BluePrism task in a specific project:

1. In Business Central, go to the projects view, select a space and the project you want to configure.
2. Select the `settings` tab, and next, `Deployments`. Locate and select the `Work Item  Handlers` menu. Click on `Add Work Item Handler`.
image:images/2-project-config.png[]

3. Input the task configuration:
* On the `Name` field: `BluePrismWS`
* On the `Value` field,  where, you need to replace the `user` and `password` with valid connection credentials for the blueprism web services you are connecting to.

```
new com.redhat.demo.BluePrismWSWorkItemHandler(ksession,classLoader,5000,"user","password")
```

4. You can either install the task to be visible for all processes authoring or just for a specific group of processes. In this case, we will configure the task for a group of processes under a specific package. So, identify or create the package where the processes will be stored.

5. Click on import and choose the package you defined on step 4. Import the bp-icon.png and the BluePrismWS.wid files to this package. See an example below where the processes would be stored in a `custom` package:

image:images/3-import-wid.png[]

#### Using the BluePrism Task

You can now use a BluePrism task to invoke Digital Workers via BluePrism SOAP Web Services.

image:images/4-blueprism-wih.png[]

This custom BluePrism task is an extension of an RHPAM `WebService Task`. Once you open the task properties `Data Assignments`, it should display by default the following configurations:

image:images/5-blueprism-wih-parameters.png[]

See more details about each configuration below. Let's consider a task which triggers a SOAP WebService like `PrepareHardwareSpecification.wsdl`.

* Data Inputs and Assignments
** *Namespace*: Namespace of BluePrism SOAP Service. Example: `urn:blueprism:webservice:preparehardwarespecification`
** *Interface*: Interface of BluePrism SOAP Service. Example: `PrepareHardwareSpecificationService`
** *Mode*: Can be `SYNC` or `ASYNC`.
** *Operation*: BluePrism SOAP Service operation to invoke. Example: `PrepareHardwareSpecification`
** *Url*: Accessible URL where BluePrism Service is available. Example: http://myblueprism:8181/ws/PrepareHardwareSpecification?wsdl
** *Parameter*: The process variable that will be sent as an input parameter. The `Data Type` should be set according to the process variable class. 

* Data Outputs and Assignments
** Result

General Notes:

* *[1]* _BluePrism Web Services are currently exposed only via SOAP._
* *[2]* _Red Hat supports for RHPAM the creation and usage of custom tasks, although the code within the custom task is not supported. Therefore, the task provided on this guide is for demonstration purposes only and is not officially supported_.
* *[3]* _Due to a known behavior on the designer, this guide instructs to user to manually copy the icon task. This will be improved on next releases. More details can be found in https://issues.redhat.com/browse/RHPAM-2418._
